<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>smallsh: include/events/sender.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">smallsh
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Simple implementation of a Linux shell written in C.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_c33611b4dec78f96017d2ccf425d656a.html">events</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sender.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Responsible for sending messages to subscribers via a dedicated <a class="el" href="structChannel.html" title="A Channel object consists of a read end and a write end, as well as a callback handler function that ...">Channel</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="channel_8h_source.html">channel.h</a>&quot;</code><br />
</div>
<p><a href="sender_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSender.html">Sender</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <code><a class="el" href="structSender.html" title="A Sender object consists of an array of Channels that it is responsible for sending messages to on re...">Sender</a></code> object consists of an array of <code>Channels</code> that it is responsible for sending messages to on receipt of signal-generated events.  <a href="structSender.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aab863276e1e12ef4b211877c91e11acb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sender_8h.html#aab863276e1e12ef4b211877c91e11acb">sender_add</a> (<a class="el" href="structSender.html">Sender</a> *self, <a class="el" href="structChannel.html">Channel</a> *ch)</td></tr>
<tr class="memdesc:aab863276e1e12ef4b211877c91e11acb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a new <code><a class="el" href="structChannel.html" title="A Channel object consists of a read end and a write end, as well as a callback handler function that ...">Channel</a></code> to its channel list, and initializes its write end.  <a href="sender_8h.html#aab863276e1e12ef4b211877c91e11acb">More...</a><br /></td></tr>
<tr class="separator:aab863276e1e12ef4b211877c91e11acb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0641c6a72fb9606c6e93200fb13098d1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sender_8h.html#a0641c6a72fb9606c6e93200fb13098d1">sender_ctor</a> (<a class="el" href="structSender.html">Sender</a> *self, size_t max_ch)</td></tr>
<tr class="memdesc:a0641c6a72fb9606c6e93200fb13098d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes <code>self</code> with provided data.  <a href="sender_8h.html#a0641c6a72fb9606c6e93200fb13098d1">More...</a><br /></td></tr>
<tr class="separator:a0641c6a72fb9606c6e93200fb13098d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a533a37ce0fc01b242ac7f143d4fb106a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sender_8h.html#a533a37ce0fc01b242ac7f143d4fb106a">sender_dtor</a> (<a class="el" href="structSender.html">Sender</a> *self)</td></tr>
<tr class="memdesc:a533a37ce0fc01b242ac7f143d4fb106a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets <code>self's</code> values.  <a href="sender_8h.html#a533a37ce0fc01b242ac7f143d4fb106a">More...</a><br /></td></tr>
<tr class="separator:a533a37ce0fc01b242ac7f143d4fb106a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a480b90bd37ac42bd758e2c7782183618"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sender_8h.html#a480b90bd37ac42bd758e2c7782183618">sender_notify_sigchld</a> (struct <a class="el" href="structChannel.html">Channel</a> ch)</td></tr>
<tr class="memdesc:a480b90bd37ac42bd758e2c7782183618"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends data received via a SIGCHLD signal to <code>self</code>.  <a href="sender_8h.html#a480b90bd37ac42bd758e2c7782183618">More...</a><br /></td></tr>
<tr class="separator:a480b90bd37ac42bd758e2c7782183618"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Responsible for sending messages to subscribers via a dedicated <a class="el" href="structChannel.html" title="A Channel object consists of a read end and a write end, as well as a callback handler function that ...">Channel</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Mohamed Al-Hussein </dd></dl>
<dl class="section date"><dt>Date</dt><dd>09 Feb 2022 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aab863276e1e12ef4b211877c91e11acb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab863276e1e12ef4b211877c91e11acb">&#9670;&nbsp;</a></span>sender_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sender_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSender.html">Sender</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structChannel.html">Channel</a> *&#160;</td>
          <td class="paramname"><em>ch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a new <code><a class="el" href="structChannel.html" title="A Channel object consists of a read end and a write end, as well as a callback handler function that ...">Channel</a></code> to its channel list, and initializes its write end. </p>
<p>Behind the scenes, this function initializes the channel pipe's write end and sets it to be non-blocking as per the self-pipe trick requirements. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td><code><a class="el" href="structSender.html" title="A Sender object consists of an array of Channels that it is responsible for sending messages to on re...">Sender</a></code> to add channel to </td></tr>
    <tr><td class="paramname">ch</td><td><code><a class="el" href="structChannel.html" title="A Channel object consists of a read end and a write end, as well as a callback handler function that ...">Channel</a></code> to add to sender </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

<p class="reference">References <a class="el" href="structChannel.html#ad874d338cec1167c20e7e503f50a212d">Channel::ch_write</a>, and <a class="el" href="status_8h.html#a685506d2c432425b89581f85cf876f22">status()</a>.</p>

<p class="reference">Referenced by <a class="el" href="events_8c.html#a81ce7d6909034de9c012d78ae23c3f42">events_init()</a>.</p>

</div>
</div>
<a id="a0641c6a72fb9606c6e93200fb13098d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0641c6a72fb9606c6e93200fb13098d1">&#9670;&nbsp;</a></span>sender_ctor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sender_ctor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSender.html">Sender</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_ch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes <code>self</code> with provided data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td><code><a class="el" href="structSender.html" title="A Sender object consists of an array of Channels that it is responsible for sending messages to on re...">Sender</a></code> to initialize </td></tr>
    <tr><td class="paramname">max_ch</td><td>maximum number of channels sender will support </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

<p class="reference">Referenced by <a class="el" href="events_8c.html#a81ce7d6909034de9c012d78ae23c3f42">events_init()</a>.</p>

</div>
</div>
<a id="a533a37ce0fc01b242ac7f143d4fb106a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a533a37ce0fc01b242ac7f143d4fb106a">&#9670;&nbsp;</a></span>sender_dtor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sender_dtor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSender.html">Sender</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets <code>self's</code> values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td><code><a class="el" href="structSender.html" title="A Sender object consists of an array of Channels that it is responsible for sending messages to on re...">Sender</a></code> to reset </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This does not clear the actual channels by calling their respective destructors. It is the caller's responsibility to do so afterwards. </dd></dl>

<p class="reference">Referenced by <a class="el" href="events_8c.html#a64bde057407debd7862302dda094b6ed">events_cleanup()</a>.</p>

</div>
</div>
<a id="a480b90bd37ac42bd758e2c7782183618"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a480b90bd37ac42bd758e2c7782183618">&#9670;&nbsp;</a></span>sender_notify_sigchld()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sender_notify_sigchld </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structChannel.html">Channel</a>&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends data received via a SIGCHLD signal to <code>self</code>. </p>
<p>This function abstracts the signal-handling step used in the self-pipe trick (TLPI section 63.5.2) in an attempt to relay SIGCHLD data while doing its best at remaining async-safe.</p>
<p>Only async-safe system calls are made within this function, and the only global data type that is being accessed within is the pipe's write file descriptor, which is done so for reads only, and without any dereferences. The file descriptor is initialized on program startup, and remains unchanged until program termination.</p>
<p>The data sent is used for updating the shell's global job table, as it requires information on both which child completed and what their exit status was. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ch</td><td><code><a class="el" href="structChannel.html" title="A Channel object consists of a read end and a write end, as well as a callback handler function that ...">Channel</a></code> to send data to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

<p class="reference">References <a class="el" href="structChannel.html#ad874d338cec1167c20e7e503f50a212d">Channel::ch_write</a>, <a class="el" href="structSigchldDTO.html#a4a3b6d71f036c6b8f9cc0e07287307f7">SigchldDTO::chld_pid</a>, <a class="el" href="structSigchldDTO.html#a6a444cc7e2b4feea515de9823d2858ce">SigchldDTO::chld_status</a>, and <a class="el" href="status_8h.html#a685506d2c432425b89581f85cf876f22">status()</a>.</p>

<p class="reference">Referenced by <a class="el" href="handler_8c.html#a1afb82a207441052c002d287c4fc6a26">handler_handle_sigchld()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
