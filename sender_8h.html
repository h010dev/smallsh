<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>smallsh: include/events/sender.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">smallsh
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Simple implementation of a Linux shell written in C.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_c33611b4dec78f96017d2ccf425d656a.html">events</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">sender.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Responsible for sending messages to subscribers via a dedicated Channel.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="channel_8h_source.html">channel.h</a>&quot;</code><br />
</div>
<p><a href="sender_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSH__Sender.html">SH_Sender</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <code>Sender</code> object consists of an array of <code>Channels</code> that it is responsible for sending messages to on receipt of signal-generated events.  <a href="structSH__Sender.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0922f9c75f66fa988a3100524b9f658d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sender_8h.html#a0922f9c75f66fa988a3100524b9f658d">SH_SenderAddChannel</a> (<a class="el" href="structSH__Sender.html">SH_Sender</a> *<a class="el" href="smallsh_8c.html#ab5f7f2dd44302d81930a9e81959f6f49">sender</a>, <a class="el" href="structSH__Channel.html">SH_Channel</a> *channel)</td></tr>
<tr class="memdesc:a0922f9c75f66fa988a3100524b9f658d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a new <code>Channel</code> to its channel list, and initializes its write end.  <a href="sender_8h.html#a0922f9c75f66fa988a3100524b9f658d">More...</a><br /></td></tr>
<tr class="separator:a0922f9c75f66fa988a3100524b9f658d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42b4f0d090daf1d541171ca7dec835a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structSH__Sender.html">SH_Sender</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sender_8h.html#a42b4f0d090daf1d541171ca7dec835a9">SH_CreateSender</a> (size_t capacity)</td></tr>
<tr class="memdesc:a42b4f0d090daf1d541171ca7dec835a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes new <code>Sender</code> object.  <a href="sender_8h.html#a42b4f0d090daf1d541171ca7dec835a9">More...</a><br /></td></tr>
<tr class="separator:a42b4f0d090daf1d541171ca7dec835a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a851324c767df15c4e3b8fffef7f8ff85"><td class="memItemLeft" align="right" valign="top">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD void <a class="el" href="sender_8c.html#adc16213bc8ade172685a714cca5c355f">SH_DestroySender</a>(<a class="el" href="structSH__Sender.html">SH_Sender</a> **<a class="el" href="smallsh_8c.html#ab5f7f2dd44302d81930a9e81959f6f49">sender</a>);=======void <a class="el" href="sender_8c.html#adc16213bc8ade172685a714cca5c355f">SH_DestroySender</a>(<a class="el" href="structSH__Sender.html">SH_Sender</a> *<a class="el" href="smallsh_8c.html#ab5f7f2dd44302d81930a9e81959f6f49">sender</a>);&gt;&gt;&gt;&gt;&gt;&gt; Refactor Events modules int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sender_8h.html#a851324c767df15c4e3b8fffef7f8ff85">SH_SenderNotifySigchldEvent</a> (<a class="el" href="structSH__Channel.html">SH_Channel</a> *channel)</td></tr>
<tr class="memdesc:a851324c767df15c4e3b8fffef7f8ff85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets <code>self's</code> values.  <a href="sender_8h.html#a851324c767df15c4e3b8fffef7f8ff85">More...</a><br /></td></tr>
<tr class="separator:a851324c767df15c4e3b8fffef7f8ff85"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Responsible for sending messages to subscribers via a dedicated Channel. </p>
<dl class="section author"><dt>Author</dt><dd>Mohamed Al-Hussein </dd></dl>
<dl class="section date"><dt>Date</dt><dd>09 Feb 2022 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a42b4f0d090daf1d541171ca7dec835a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42b4f0d090daf1d541171ca7dec835a9">&#9670;&nbsp;</a></span>SH_CreateSender()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSH__Sender.html">SH_Sender</a>* SH_CreateSender </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>capacity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes new <code>Sender</code> object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sender</td><td><code>Sender</code> to initialize </td></tr>
    <tr><td class="paramname">capacity</td><td>maximum number of channels sender will support </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new <code>Sender</code> object on success, <code>NULL</code> on failure </dd></dl>

<p class="reference">References <a class="el" href="structSH__Sender.html#a06797ddc2b029517f42d173658ddaeda">SH_Sender::capacity</a>, <a class="el" href="structSH__Sender.html#a641397b809318cb3643c14a063bf573f">SH_Sender::channels</a>, <a class="el" href="events_8h.html#ab5f7f2dd44302d81930a9e81959f6f49">sender</a>, and <a class="el" href="structSH__Sender.html#ab51deb9ccab6e70ceec689bfba932601">SH_Sender::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="events_8c.html#aa8e2e0f6415a6ff5388a0a0929a7ab53">SH_InitEvents()</a>.</p>

</div>
</div>
<a id="a0922f9c75f66fa988a3100524b9f658d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0922f9c75f66fa988a3100524b9f658d">&#9670;&nbsp;</a></span>SH_SenderAddChannel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SH_SenderAddChannel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSH__Sender.html">SH_Sender</a> *&#160;</td>
          <td class="paramname"><em>sender</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSH__Channel.html">SH_Channel</a> *&#160;</td>
          <td class="paramname"><em>channel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a new <code>Channel</code> to its channel list, and initializes its write end. </p>
<p>Behind the scenes, this function initializes the channel pipe's write end and sets it to be non-blocking as per the self-pipe trick requirements. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sender</td><td><code>Sender</code> to add channel to </td></tr>
    <tr><td class="paramname">channel</td><td><code>Channel</code> to add to sender </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

<p class="reference">References <a class="el" href="structSH__Sender.html#a06797ddc2b029517f42d173658ddaeda">SH_Sender::capacity</a>, <a class="el" href="structSH__Sender.html#a641397b809318cb3643c14a063bf573f">SH_Sender::channels</a>, <a class="el" href="events_8h.html#ab5f7f2dd44302d81930a9e81959f6f49">sender</a>, <a class="el" href="structSH__Sender.html#ab51deb9ccab6e70ceec689bfba932601">SH_Sender::size</a>, and <a class="el" href="structSH__Channel.html#a70035aec57d4e0a739c4a30f6f923764">SH_Channel::write_fd</a>.</p>

<p class="reference">Referenced by <a class="el" href="events_8c.html#aa8e2e0f6415a6ff5388a0a0929a7ab53">SH_InitEvents()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a851324c767df15c4e3b8fffef7f8ff85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a851324c767df15c4e3b8fffef7f8ff85">&#9670;&nbsp;</a></span>SH_SenderNotifySigchldEvent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD void <a class="el" href="sender_8c.html#adc16213bc8ade172685a714cca5c355f">SH_DestroySender</a>(<a class="el" href="structSH__Sender.html">SH_Sender</a> **<a class="el" href="smallsh_8c.html#ab5f7f2dd44302d81930a9e81959f6f49">sender</a>); ======= void <a class="el" href="sender_8c.html#adc16213bc8ade172685a714cca5c355f">SH_DestroySender</a>(<a class="el" href="structSH__Sender.html">SH_Sender</a> *<a class="el" href="smallsh_8c.html#ab5f7f2dd44302d81930a9e81959f6f49">sender</a>); &gt;&gt;&gt;&gt;&gt;&gt; Refactor Events modules int SH_SenderNotifySigchldEvent(<a class="el" href="structSH__Channel.html">SH_Channel</a> *channel)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets <code>self's</code> values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sender</td><td><code>Sender</code> to reset </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This does not clear the actual channels by calling their respective destructors. It is the caller's responsibility to do so afterwards.</dd></dl>
<p>Sends data received via a SIGCHLD signal to <code>self</code>.</p>
<p>This function abstracts the signal-handling step used in the self-pipe trick (TLPI section 63.5.2) in an attempt to relay SIGCHLD data while doing its best at remaining async-safe.</p>
<p>Only async-safe system calls are made within this function, and the only global data type that is being accessed within is the pipe's write file descriptor, which is done so for reads only, and without any dereferences. The file descriptor is initialized on program startup, and remains unchanged until program termination.</p>
<p>The data sent is used for updating the shell's global job table, as it requires information on both which child completed and what their exit status was. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">channel</td><td><code>Channel</code> to send data to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

<p class="reference">Referenced by <a class="el" href="handler_8c.html#a2488cd6d7cf4a777a47cd4bc87ba449d">SH_HandlerHandleSigchld()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
